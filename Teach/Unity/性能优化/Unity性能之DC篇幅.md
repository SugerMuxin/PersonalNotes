---
tags:
  - unity
author: RuoSaChen
---



渲染和画油画有一点类似，先会打一层底色，然后根据场景的近远从一层一层的话，不过画下一层的时候需要等待上一层的颜料彻底干了才能再在上面糊。

Drawcall就和这个层差不多，如果层数多的话明显就需要更多的运算，更长的时间。就会增加CPU，GPU等各方元器件的运行压力，产生更多的热量。

一般会控制游戏的帧率为30或者60（当帧率超过24时，人眼就就基本感觉不到了），那么一帧的时间就是0.016s或者0.033s,也就是16ms或者33ms，在这一帧之内需要完成内存数据到CPU的运算到GPU的渲染等等的一些列操作。（tip：所以update中不能做复杂的操作），以60fps为例，假如利用了15ms才能完成所有的操作，那么元器件就只剩下1ms的时间在休眠状态，也就会持续的产生热量，这样会造成手机发烫，假如16ms都不够完成的话，那就会出现明显的卡顿现象，影响用户体验。

所以如果一般在手机能跑到50帧但是发烫的情况下，我们会限制帧率为30，这样可以让元器件有更多的休息时间可以散热。类似于以前你一天上班工作16个小时，毫无疑问会累的要死，但是现在强制不许加班，只允许上班8小时，体验瞬间就好了很多。

Drawcall是CPU对底层图形绘制接口的调用命令GPU执行渲染操作，渲染流程采用流水线实现，CPU和GPU并行工作，它们之间通过命令缓冲区连接，CPU向其中发送渲染命令，GPU接收并执行对应的渲染命令。

降低Drawcall的主要方法是减少场景或者UI上使用的材质种类，并通过合批，合并图集的方式来减少数量。需要注意的是，并非Drawcall越低越好。因为决定渲染模块性能的除了Drawcall之外，还有用于传输渲染数据的总线带宽。当我们使用Drawcall Batching将同种材质的网格模型拼接在一起的时候，可能会造成一次DC中需要传输的数据（Texture,Mesh等）过大，以至于带宽堵塞，在资源无法及时传输到显存的时候，GPU只能暂时歇业，反而会降低帧率。




-----------------------------------------------------------------------------------
批次上

我们会在直观上可能会觉得 Unity 的Hierencey的视图中的顺序会不会影响GPU渲染的顺序，事实上是没有大影响的，GPU的 drawcall 的顺序和很多因素有关。之所以说没有太影响，是因为Unity在收集需要渲染对象的时候和视图中的对象顺序多少存在一点关系。有点类似于学校开展运动会，去召集所有的运动员，可能会从一楼往三楼一个班级一个班级去找一遍，但是最终

1. RenderType  Opeaque 的队列始终会在 Transparency的队列之前渲染
2. "Queue"="Transparent+30"  一定会在   "Queue"="Transparent" 
		Queue="Geometry" 的物体也会在 "Queue"="Transparent"之前渲染
 3. Layer 越低的 Layer
------------------------------------------------------------

1.模板测试：
	https://zhuanlan.zhihu.com/p/612811622



![[Pasted image 20250424134602.png]]
1.Compute Internal-Skinning 是什么，干什么，又有什么消耗
	Compute Internal-Skinning 和Unity的蒙皮网格有关， Unity将蒙皮的相关计算转移到GPU。- 传统蒙皮动画（Skinning）通过CPU计算骨骼对顶点的权重变换，再将结果传递给GPU渲染（称为 **CPU Skinning**）。- **Compute Internal-Skinning** 则利用GPU的Compute Shader，直接在GPU上并行计算骨骼对顶点的变换，称为 **GPU Skinning**。


![[Pasted image 20250424140817.png]]
2.生成深度纹理的消耗取决于几个因素：场景的复杂度（顶点数量、覆盖的像素数量）、渲染分辨率、以及是否启用了MSAA等抗锯齿技术。如果是通过复制深度缓冲区，可能在带宽上有较大的消耗，尤其是在高分辨率下。如果是通过渲染Pass生成，那么需要额外的绘制调用和着色器计算，可能增加GPU的工作负载。
```
     - 在Forward 渲染Path 下开启深度
     camera.depthTextureMode = DepthTextureMode.Depth; 

	 - 在Shader中可以使用 _CameraDepthTexture
	 - 在Shader中使用 `#if defined(UNITY_DEPTH_TEXTURE_SUPPORT)` 条件编译，避免在不支持的设备上采样深度。
	 - 
```

